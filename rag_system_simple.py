# -*- coding: utf-8 -*-
"""
RAG-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π –ø–æ —é–≤–µ–ª–∏—Ä–Ω—ã–º –∏–∑–¥–µ–ª–∏—è–º (–£–ü–†–û–©–ï–ù–ù–ê–Ø –ë–´–°–¢–†–ê–Ø –í–ï–†–°–ò–Ø)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ LLM
–†–∞–±–æ—Ç–∞–µ—Ç –ú–ì–ù–û–í–ï–ù–ù–û, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç OpenAI API –∏ —Ç—è–∂–µ–ª—ã—Ö –º–æ–¥–µ–ª–µ–π
"""

import os
import sys
import json
from pathlib import Path

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –¥–ª—è Windows
if sys.platform == 'win32':
    import codecs
    if hasattr(sys.stdout, 'buffer'):
        sys.stdout = codecs.getwriter('utf-8')(sys.stdout.buffer, 'strict')
    if hasattr(sys.stderr, 'buffer'):
        sys.stderr = codecs.getwriter('utf-8')(sys.stderr.buffer, 'strict')
    os.environ['PYTHONIOENCODING'] = 'utf-8'
    os.environ['PYTHONUTF8'] = '1'

# –ò–º–ø–æ—Ä—Ç—ã LangChain –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
from langchain_core.documents import Document
from langchain_community.vectorstores import FAISS

# –ò–º–ø–æ—Ä—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
try:
    from langchain_huggingface import HuggingFaceEmbeddings
except ImportError:
    from langchain_community.embeddings import HuggingFaceEmbeddings
    import warnings
    warnings.filterwarnings('ignore', category=DeprecationWarning)


class RAGSystemSimple:
    """–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –±—ã—Å—Ç—Ä–∞—è RAG-—Å–∏—Å—Ç–µ–º–∞ –±–µ–∑ LLM"""
    
    def __init__(self, base_dir: Path):
        self.base_dir = base_dir
        self.data_dir = base_dir / "data"
        self.output_dir = base_dir / "output"
        self.faiss_index_dir = base_dir / "faiss_index"
        self.catalog_file = base_dir / "catalog.json"
        self.knowledge_file = base_dir / "knowledge_base.json"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
        self.data_dir.mkdir(exist_ok=True)
        self.output_dir.mkdir(exist_ok=True)
        self.faiss_index_dir.mkdir(exist_ok=True)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self.embeddings_model = None
        self.db = None
        self.retriever = None
        self.catalog_db = None
        self.catalog_retriever = None
        self.catalog_data = []
        self.knowledge_data = []
        
    def initialize_embeddings(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤"""
        print("–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤...")
        self.embeddings_model = HuggingFaceEmbeddings(
            model_name="intfloat/multilingual-e5-large",
            model_kwargs={'device': 'cpu'}
        )
        print("‚úì –ú–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
    
    def create_knowledge_base_data(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± —É—Ö–æ–¥–µ –∑–∞ —É–∫—Ä–∞—à–µ–Ω–∏—è–º–∏"""
        knowledge = [
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ –∑–æ–ª–æ—Ç–æ–º",
                "content": "–ó–æ–ª–æ—Ç–æ - –±–ª–∞–≥–æ—Ä–æ–¥–Ω—ã–π –º–µ—Ç–∞–ª–ª, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ç—É—Å–∫–Ω–µ–µ—Ç –∏ –Ω–µ –æ–∫–∏—Å–ª—è–µ—Ç—Å—è. –î–ª—è —á–∏—Å—Ç–∫–∏ –∑–æ–ª–æ—Ç—ã—Ö –∏–∑–¥–µ–ª–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–ø–ª—É—é –≤–æ–¥—É —Å –º—è–≥–∫–∏–º –º—ã–ª–æ–º –∏ –º—è–≥–∫—É—é —â–µ—Ç–∫—É. –ò–∑–±–µ–≥–∞–π—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å —Ö–ª–æ—Ä–æ–º –∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ —Ö–∏–º–∏–∫–∞—Ç–∞–º–∏. –•—Ä–∞–Ω–∏—Ç–µ –∑–æ–ª–æ—Ç—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥—Ä—É–≥–∏—Ö –º–µ—Ç–∞–ª–ª–æ–≤."
            },
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ —Å–µ—Ä–µ–±—Ä–æ–º",
                "content": "–°–µ—Ä–µ–±—Ä–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Ç–µ–º–Ω–µ–µ—Ç –∏–∑-–∑–∞ –æ–∫–∏—Å–ª–µ–Ω–∏—è. –ß–∏—Å—Ç–∏—Ç–µ —Å–µ—Ä–µ–±—Ä—è–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –∏–ª–∏ –ø–∞—Å—Ç–æ–π –∏–∑ —Å–æ–¥—ã –∏ –≤–æ–¥—ã. –•—Ä–∞–Ω–∏—Ç–µ –≤ —Å—É—Ö–æ–º –º–µ—Å—Ç–µ, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤ –∑–∞–∫—Ä—ã—Ç—ã—Ö —à–∫–∞—Ç—É–ª–∫–∞—Ö. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –Ω–æ—à–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ—Ç–µ–º–Ω–µ–Ω–∏–µ."
            },
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞–º–∏",
                "content": "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã - —Å–∞–º—ã–µ —Ç–≤–µ—Ä–¥—ã–µ –∫–∞–º–Ω–∏, –Ω–æ —Ç—Ä–µ–±—É—é—Ç —É—Ö–æ–¥–∞. –ß–∏—Å—Ç–∏—Ç–µ –∏—Ö —Ä–∞—Å—Ç–≤–æ—Ä–æ–º —Ç–µ–ø–ª–æ–π –≤–æ–¥—ã —Å –º—è–≥–∫–∏–º –º–æ—é—â–∏–º —Å—Ä–µ–¥—Å—Ç–≤–æ–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º—è–≥–∫—É—é –∑—É–±–Ω—É—é —â–µ—Ç–∫—É –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–π. –ò–∑–±–µ–≥–∞–π—Ç–µ —É–¥–∞—Ä–æ–≤ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –∞–±—Ä–∞–∑–∏–≤–Ω—ã–º–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—è–º–∏."
            },
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ –∂–µ–º—á—É–≥–æ–º",
                "content": "–ñ–µ–º—á—É–≥ - –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª, —Ç—Ä–µ–±—É—é—â–∏–π –æ—Å–æ–±–æ–≥–æ —É—Ö–æ–¥–∞. –ü—Ä–æ—Ç–∏—Ä–∞–π—Ç–µ –º—è–≥–∫–æ–π –≤–ª–∞–∂–Ω–æ–π —Ç–∫–∞–Ω—å—é –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –Ω–æ—à–µ–Ω–∏—è. –ò–∑–±–µ–≥–∞–π—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –∫–æ—Å–º–µ—Ç–∏–∫–æ–π, –¥—É—Ö–∞–º–∏ –∏ —Ö–∏–º–∏–∫–∞—Ç–∞–º–∏. –•—Ä–∞–Ω–∏—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥—Ä—É–≥–∏—Ö —É–∫—Ä–∞—à–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ –∂–µ–º—á—É–≥ –ª–µ–≥–∫–æ —Ü–∞—Ä–∞–ø–∞–µ—Ç—Å—è."
            },
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ –∏–∑—É–º—Ä—É–¥–∞–º–∏",
                "content": "–ò–∑—É–º—Ä—É–¥—ã —Ö—Ä—É–ø–∫–∏–µ –∏ —Ç—Ä–µ–±—É—é—Ç –±–µ—Ä–µ–∂–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è. –ß–∏—Å—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ–ø–ª–æ–π –≤–æ–¥–æ–π —Å –º—è–≥–∫–∏–º –º—ã–ª–æ–º, –±–µ–∑ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–∞. –ò–∑–±–µ–≥–∞–π—Ç–µ —Ä–µ–∑–∫–∏—Ö –ø–µ—Ä–µ–ø–∞–¥–æ–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã. –•—Ä–∞–Ω–∏—Ç–µ –≤ –º—è–≥–∫–æ–π —Ç–∫–∞–Ω–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –¥—Ä—É–≥–∏—Ö –∫–∞–º–Ω–µ–π."
            },
            {
                "topic": "–£—Ö–æ–¥ –∑–∞ —Ä—É–±–∏–Ω–∞–º–∏ –∏ —Å–∞–ø—Ñ–∏—Ä–∞–º–∏",
                "content": "–†—É–±–∏–Ω—ã –∏ —Å–∞–ø—Ñ–∏—Ä—ã - —Ç–≤–µ—Ä–¥—ã–µ –∫–∞–º–Ω–∏, —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫ —Ü–∞—Ä–∞–ø–∏–Ω–∞–º. –ú–æ–∂–Ω–æ —á–∏—Å—Ç–∏—Ç—å —Ç–µ–ø–ª–æ–π –≤–æ–¥–æ–π —Å –º—ã–ª–æ–º –∏–ª–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–∞–º–Ω–µ–π –≤ –æ–ø—Ä–∞–≤–µ."
            },
            {
                "topic": "–í—ã–±–æ—Ä —É–∫—Ä–∞—à–µ–Ω–∏–π –¥–ª—è —Å–≤–∞–¥—å–±—ã",
                "content": "–î–ª—è —Å–≤–∞–¥—å–±—ã –≤—ã–±–∏—Ä–∞–π—Ç–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —É–∫—Ä–∞—à–µ–Ω–∏—è: –æ–±—Ä—É—á–∞–ª—å–Ω—ã–µ –∫–æ–ª—å—Ü–∞ –∏–∑ –∑–æ–ª–æ—Ç–∞ –∏–ª–∏ –ø–ª–∞—Ç–∏–Ω—ã, —Å–µ—Ä—å–≥–∏ —Å –∂–µ–º—á—É–≥–æ–º –∏–ª–∏ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞–º–∏, –∏–∑—è—â–Ω–æ–µ –∫–æ–ª—å–µ. –£–∫—Ä–∞—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –≥–∞—Ä–º–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –ø–ª–∞—Ç—å–µ–º –∏ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ–±—Ä–∞–∑."
            },
            {
                "topic": "–í—ã–±–æ—Ä —É–∫—Ä–∞—à–µ–Ω–∏–π –¥–ª—è –≤–µ—á–µ—Ä–Ω–µ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                "content": "–î–ª—è –≤–µ—á–µ—Ä–Ω–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ–¥–æ–π–¥—É—Ç —è—Ä–∫–∏–µ —É–∫—Ä–∞—à–µ–Ω–∏—è: —Å–µ—Ä—å–≥–∏ —Å –∫—Ä—É–ø–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏, –∫–æ–ª—å–µ —Å —Å–∞–ø—Ñ–∏—Ä–∞–º–∏ –∏–ª–∏ –∏–∑—É–º—Ä—É–¥–∞–º–∏, –±—Ä–∞—Å–ª–µ—Ç—ã —Å –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞–º–∏. –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –±–æ–ª–µ–µ —Å–º–µ–ª—ã–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏."
            },
            {
                "topic": "–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è",
                "content": "–î–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –Ω–æ—à–µ–Ω–∏—è –≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω–µ–±—Ä–æ—Å–∫–∏–µ —É–∫—Ä–∞—à–µ–Ω–∏—è: —Ç–æ–Ω–∫–∏–µ —Ü–µ–ø–æ—á–∫–∏, –Ω–µ–±–æ–ª—å—à–∏–µ —Å–µ—Ä—å–≥–∏-–≥–≤–æ–∑–¥–∏–∫–∏, –∏–∑—è—â–Ω—ã–µ –±—Ä–∞—Å–ª–µ—Ç—ã. –°–µ—Ä–µ–±—Ä–æ –∏ –∑–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è."
            },
            {
                "topic": "–ü–æ–¥–∞—Ä–æ–∫ –Ω–∞ —é–±–∏–ª–µ–π",
                "content": "–ù–∞ —é–±–∏–ª–µ–π –¥–∞—Ä—è—Ç –∑–Ω–∞—á–∏–º—ã–µ —É–∫—Ä–∞—à–µ–Ω–∏—è: –∑–æ–ª–æ—Ç—ã–µ —á–∞—Å—ã, –∫–æ–ª—å–µ —Å –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏, –∫–æ–º–ø–ª–µ–∫—Ç—ã —É–∫—Ä–∞—à–µ–Ω–∏–π. –û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ —Å—Ç–∏–ª—å, –∫–æ—Ç–æ—Ä—ã–π –æ–Ω –Ω–æ—Å–∏—Ç."
            }
        ]
        
        with open(self.knowledge_file, 'w', encoding='utf-8') as f:
            json.dump(knowledge, f, indent=4, ensure_ascii=False)
        
        return knowledge
    
    def create_knowledge_base(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π"""
        print("–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π...")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
        if self.knowledge_file.exists():
            with open(self.knowledge_file, 'r', encoding='utf-8') as f:
                self.knowledge_data = json.load(f)
        else:
            self.knowledge_data = self.create_knowledge_base_data()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        documents = []
        for item in self.knowledge_data:
            documents.append(Document(
                page_content=item['content'],
                metadata={"topic": item['topic']}
            ))
        
        print(f"‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∑–Ω–∞–Ω–∏–π: {len(documents)}")
        
        # –°–æ–∑–¥–∞–Ω–∏–µ FAISS –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        self.db = FAISS.from_documents(documents, self.embeddings_model)
        self.retriever = self.db.as_retriever(search_type="similarity", search_kwargs={"k": 3})
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        save_path = str(self.faiss_index_dir.resolve())
        self.db.save_local(save_path)
        print(f"‚úì –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ {save_path}")
    
    def load_knowledge_base(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π"""
        save_path = str(self.faiss_index_dir.resolve())
        
        if not (self.faiss_index_dir / "index.faiss").exists():
            print("‚ö† –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –±–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π...")
            self.create_knowledge_base()
        else:
            print("–ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π...")
            self.db = FAISS.load_local(save_path, self.embeddings_model, allow_dangerous_deserialization=True)
            self.retriever = self.db.as_retriever(search_type="similarity", search_kwargs={"k": 3})
            
            # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π
            if self.knowledge_file.exists():
                with open(self.knowledge_file, 'r', encoding='utf-8') as f:
                    self.knowledge_data = json.load(f)
            
            print("‚úì –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
    
    def create_catalog(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤"""
        catalog = [
            {
                "name": "–ö–æ–ª—å—Ü–æ —Å –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–º",
                "description": "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –∫–æ–ª—å—Ü–æ —Å –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–º 0.5 –∫–∞—Ä–∞—Ç–∞",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç",
                "usage": "–ü–æ–º–æ–ª–≤–∫–∞, —Å–≤–∞–¥—å–±–∞, –æ—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏",
                "price": "15000 —Ä—É–±.",
                "url": "https://example.com/product/1"
            },
            {
                "name": "–°–µ—Ä–µ–±—Ä—è–Ω—ã–µ —Å–µ—Ä—å–≥–∏ —Å –∞–º–µ—Ç–∏—Å—Ç–∞–º–∏",
                "description": "–°–µ—Ä—å–≥–∏ –∏–∑ 925 —Å—Ç–µ—Ä–ª–∏–Ω–≥–æ–≤–æ–≥–æ —Å–µ—Ä–µ–±—Ä–∞ —Å –∞–º–µ—Ç–∏—Å—Ç–∞–º–∏ –≤—ã—Å—à–µ–π –ø—Ä–æ–±—ã",
                "material": "–°–µ—Ä–µ–±—Ä–æ 925",
                "stone": "–ê–º–µ—Ç–∏—Å—Ç",
                "usage": "–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –Ω–æ—à–µ–Ω–∏–µ, —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                "price": "8000 —Ä—É–±.",
                "url": "https://example.com/product/2"
            },
            {
                "name": "–ó–æ–ª–æ—Ç–∞—è –ø–æ–¥–≤–µ—Å–∫–∞ —Å –∏–∑—É–º—Ä—É–¥–æ–º",
                "description": "–ò–∑—ã—Å–∫–∞–Ω–Ω–∞—è –ø–æ–¥–≤–µ—Å–∫–∞ –∏–∑ 14-–∫–∞—Ä–∞—Ç–Ω–æ–≥–æ –∑–æ–ª–æ—Ç–∞ —Å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º –∏–∑—É–º—Ä—É–¥–æ–º",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–ò–∑—É–º—Ä—É–¥",
                "usage": "–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã–π –∏ –≤–µ—á–µ—Ä–Ω–∏–π –æ–±—Ä–∞–∑",
                "price": "22000 —Ä—É–±.",
                "url": "https://example.com/product/3"
            },
            {
                "name": "–ë—Ä–∞—Å–ª–µ—Ç —Å —Ü–∏—Ä–∫–æ–Ω–∞–º–∏",
                "description": "–¢–æ–Ω–∫–∏–π –±—Ä–∞—Å–ª–µ—Ç —Å –≤—Å—Ç–∞–≤–∫–∞–º–∏ –∏–∑ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ü–∏—Ä–∫–æ–Ω–æ–≤",
                "material": "–°–µ—Ä–µ–±—Ä–æ 925",
                "stone": "–¶–∏—Ä–∫–æ–Ω—ã",
                "usage": "–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏, —Å—Ç–∏–ª—å–Ω—ã–π –∞–∫—Å–µ—Å—Å—É–∞—Ä",
                "price": "3500 —Ä—É–±.",
                "url": "https://example.com/product/4"
            },
            {
                "name": "–°–µ—Ä—å–≥–∏ —Å –∂–µ–º—á—É–≥–æ–º",
                "description": "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä—å–≥–∏ —Å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º –∂–µ–º—á—É–≥–æ–º –∏ –∑–æ–ª–æ—Ç—ã–º–∏ –≤—Å—Ç–∞–≤–∫–∞–º–∏",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–ñ–µ–º—á—É–≥",
                "usage": "–ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–µ –Ω–æ—à–µ–Ω–∏–µ, —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                "price": "10000 —Ä—É–±.",
                "url": "https://example.com/product/5"
            },
            {
                "name": "–ß–∞—Å—ã —Å –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞–º–∏",
                "description": "–®–∏–∫–∞—Ä–Ω—ã–µ —á–∞—Å—ã —Å –∏–Ω–∫—Ä—É—Å—Ç–∞—Ü–∏–µ–π –∏–∑ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤ –Ω–∞ —Ü–∏—Ñ–µ—Ä–±–ª–∞—Ç–µ",
                "material": "–ó–æ–ª–æ—Ç–æ 750 –ø—Ä–æ–±—ã",
                "stone": "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã",
                "usage": "–î–ª—è —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏–∑—ã—Å–∫–∞–Ω–Ω–æ–≥–æ —Å—Ç–∏–ª—è",
                "price": "50000 —Ä—É–±.",
                "url": "https://example.com/product/6"
            },
            {
                "name": "–ö—É–ª–æ–Ω —Å —Ç–æ–ø–∞–∑–æ–º",
                "description": "–ò–∑—è—â–Ω—ã–π –∫—É–ª–æ–Ω —Å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º —Ç–æ–ø–∞–∑–æ–º –≤ —Å–µ—Ä–µ–±—Ä—è–Ω–æ–π –æ–ø—Ä–∞–≤–µ",
                "material": "–°–µ—Ä–µ–±—Ä–æ 925",
                "stone": "–¢–æ–ø–∞–∑",
                "usage": "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏ –∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å—Ç–∏–ª—å",
                "price": "7000 —Ä—É–±.",
                "url": "https://example.com/product/7"
            },
            {
                "name": "–ó–æ–ª–æ—Ç—ã–µ –æ–±—Ä—É—á–∞–ª—å–Ω—ã–µ –∫–æ–ª—å—Ü–∞",
                "description": "–ü–∞—Ä–∞ –∑–æ–ª–æ—Ç—ã—Ö –æ–±—Ä—É—á–∞–ª—å–Ω—ã—Ö –∫–æ–ª–µ—Ü —Å –º–∞—Ç–æ–≤–æ–π –æ—Ç–¥–µ–ª–∫–æ–π –∏ –≥—Ä–∞–≤–∏—Ä–æ–≤–∫–æ–π",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–ë–µ–∑ –∫–∞–º–Ω–µ–π",
                "usage": "–°–≤–∞–¥—å–±–∞",
                "price": "25000 —Ä—É–±.",
                "url": "https://example.com/product/8"
            },
            {
                "name": "–ü–µ—á–∞—Ç–∫–∞ —Å –æ–Ω–∏–∫—Å–æ–º",
                "description": "–ú—É–∂—Å–∫–∞—è –ø–µ—á–∞—Ç–∫–∞ —Å –æ–Ω–∏–∫—Å–æ–º –≤ —Å–µ—Ä–µ–±—Ä—è–Ω–æ–π –æ–ø—Ä–∞–≤–µ",
                "material": "–°–µ—Ä–µ–±—Ä–æ 925",
                "stone": "–û–Ω–∏–∫—Å",
                "usage": "–î–ª—è —Å—Ç–∏–ª—å–Ω—ã—Ö –º—É–∂—á–∏–Ω",
                "price": "12000 —Ä—É–±.",
                "url": "https://example.com/product/9"
            },
            {
                "name": "–ö–æ–ª—å–µ —Å —Å–∞–ø—Ñ–∏—Ä–∞–º–∏",
                "description": "–†–æ—Å–∫–æ—à–Ω–æ–µ –∫–æ–ª—å–µ —Å –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º–∏ —Å–∞–ø—Ñ–∏—Ä–∞–º–∏ –∏ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞–º–∏",
                "material": "–ó–æ–ª–æ—Ç–æ 750 –ø—Ä–æ–±—ã",
                "stone": "–°–∞–ø—Ñ–∏—Ä—ã, –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã",
                "usage": "–í–µ—á–µ—Ä–∏–Ω–∫–∏, —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                "price": "45000 —Ä—É–±.",
                "url": "https://example.com/product/10"
            },
            {
                "name": "–ö–æ–ª—å—Ü–æ —Å —Ä—É–±–∏–Ω–æ–º",
                "description": "–†–æ—Å–∫–æ—à–Ω–æ–µ –∑–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ —Å –∫—Ä—É–ø–Ω—ã–º –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º –∫—Ä–∞—Å–Ω—ã–º —Ä—É–±–∏–Ω–æ–º",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–†—É–±–∏–Ω",
                "usage": "–û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏, —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
                "price": "35000 —Ä—É–±.",
                "url": "https://example.com/product/11"
            },
            {
                "name": "–ó–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ —Å –≥—Ä–∞–Ω–∞—Ç–æ–º",
                "description": "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –∑–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ —Å –±–æ–ª—å—à–∏–º –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–º –∫—Ä–∞—Å–Ω—ã–º –≥—Ä–∞–Ω–∞—Ç–æ–º",
                "material": "–ó–æ–ª–æ—Ç–æ 585 –ø—Ä–æ–±—ã",
                "stone": "–ì—Ä–∞–Ω–∞—Ç",
                "usage": "–í–µ—á–µ—Ä–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –ø–æ–¥–∞—Ä–æ–∫",
                "price": "18000 —Ä—É–±.",
                "url": "https://example.com/product/12"
            }
        ]
        
        with open(self.catalog_file, 'w', encoding='utf-8') as f:
            json.dump(catalog, f, indent=4, ensure_ascii=False)
        
        return catalog
    
    def create_catalog_database(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞"""
        print("–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞...")
        
        if self.catalog_file.exists():
            with open(self.catalog_file, 'r', encoding='utf-8') as f:
                self.catalog_data = json.load(f)
        else:
            self.catalog_data = self.create_catalog()
        
        documents = []
        for item in self.catalog_data:
            # –°–æ–∑–¥–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–∏—Å–∫–∞
            description = item.get('description', '')
            material = item.get('material', '')
            stone = item.get('stone', '')
            usage = item.get('usage', '')
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–µ–π
            parts = [description]
            if material:
                parts.append(f"–ú–∞—Ç–µ—Ä–∏–∞–ª: {material}")
            if stone:
                parts.append(f"–ö–∞–º–µ–Ω—å: {stone}")
            if usage:
                parts.append(usage)
            
            full_description = ". ".join(parts)
            documents.append(Document(
                page_content=full_description,
                metadata=item
            ))
        
        self.catalog_db = FAISS.from_documents(documents, self.embeddings_model)
        self.catalog_retriever = self.catalog_db.as_retriever(
            search_type="similarity",
            search_kwargs={"k": 3}
        )
        print(f"‚úì –ë–∞–∑–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å–æ–∑–¥–∞–Ω–∞ ({len(documents)} —Ç–æ–≤–∞—Ä–æ–≤)")
    
    def format_answer(self, question: str, context_docs: list, product_docs: list) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
        answer = []
        
        # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –∑–Ω–∞–Ω–∏—è
        if context_docs:
            answer.append("üìö –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤–∞—à–µ–º—É –≤–æ–ø—Ä–æ—Å—É:\n")
            for i, doc in enumerate(context_docs, 1):
                topic = doc.metadata.get('topic', '–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è')
                answer.append(f"{i}. {topic}")
                answer.append(f"   {doc.page_content}\n")
        
        # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ç–æ–≤–∞—Ä—ã
        if product_docs:
            answer.append("\nüíé –ü–æ–¥—Ö–æ–¥—è—â–∏–µ —É–∫—Ä–∞—à–µ–Ω–∏—è –∏–∑ –Ω–∞—à–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞:\n")
            for i, doc in enumerate(product_docs, 1):
                meta = doc.metadata
                answer.append(f"{i}. {meta.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')}")
                answer.append(f"   ‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: {meta.get('description', '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è')}")
                
                if 'material' in meta:
                    answer.append(f"   ‚Ä¢ –ú–∞—Ç–µ—Ä–∏–∞–ª: {meta['material']}")
                if 'stone' in meta:
                    answer.append(f"   ‚Ä¢ –ö–∞–º–µ–Ω—å: {meta['stone']}")
                    
                answer.append(f"   ‚Ä¢ –¶–µ–Ω–∞: {meta.get('price', '–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞')}")
                
                if 'usage' in meta:
                    answer.append(f"   ‚Ä¢ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è: {meta['usage']}")
                    
                answer.append(f"   ‚Ä¢ –°—Å—ã–ª–∫–∞: {meta.get('url', '#')}\n")
        
        if not context_docs and not product_docs:
            answer.append("–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ –Ω–∞—à–µ–ª —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É.")
            answer.append("\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å.")
            answer.append("\n–ù–∞–ø—Ä–∏–º–µ—Ä:")
            answer.append("  ‚Ä¢ '–ö–∞–∫ —É—Ö–∞–∂–∏–≤–∞—Ç—å –∑–∞ –∑–æ–ª–æ—Ç–æ–º?'")
            answer.append("  ‚Ä¢ '–ü–æ–∫–∞–∂–∏ –∫–æ–ª—å—Ü–∞ —Å –∫—Ä–∞—Å–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏'")
            answer.append("  ‚Ä¢ '–ß—Ç–æ –ø–æ–¥–∞—Ä–∏—Ç—å –Ω–∞ —Å–≤–∞–¥—å–±—É?'")
        
        return "\n".join(answer)
    
    def query(self, question: str) -> str:
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ RAG-—Å–∏—Å—Ç–µ–º–µ"""
        context_docs = []
        product_docs = []
        
        try:
            context_docs = self.retriever.invoke(question)
        except Exception as e:
            print(f"‚ö† –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: {e}")
        
        try:
            product_docs = self.catalog_retriever.invoke(question)
        except Exception as e:
            print(f"‚ö† –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤: {e}")
        
        return self.format_answer(question, context_docs, product_docs)
    
    def run_interactive(self):
        """–ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞"""
        print("\n" + "="*60)
        print("RAG-–°–ò–°–¢–ï–ú–ê: –ö–û–ù–°–£–õ–¨–¢–ê–ù–¢ –ü–û –Æ–í–ï–õ–ò–†–ù–´–ú –ò–ó–î–ï–õ–ò–Ø–ú")
        print("(–ë—ã—Å—Ç—Ä–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ LLM)")
        print("="*60)
        print("\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –ø–æ–º–æ–≥—É –≤–∞–º —Å –≤—ã–±–æ—Ä–æ–º —é–≤–µ–ª–∏—Ä–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π.")
        print("\nüí° –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:")
        print("  ‚Ä¢ –ö–∞–∫ —É—Ö–∞–∂–∏–≤–∞—Ç—å –∑–∞ –∑–æ–ª–æ—Ç–æ–º?")
        print("  ‚Ä¢ –ü–æ–∫–∞–∂–∏ –∫–æ–ª—å—Ü–∞ —Å –∫—Ä–∞—Å–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏")
        print("  ‚Ä¢ –ß—Ç–æ –ø–æ–¥–∞—Ä–∏—Ç—å –Ω–∞ —Å–≤–∞–¥—å–±—É?")
        print("  ‚Ä¢ –ö–∞–∫–∏–µ —Å–µ—Ä—å–≥–∏ –ø–æ–¥–æ–π–¥—É—Ç –¥–ª—è –≤–µ—á–µ—Ä–∞?")
        print("\n–í–≤–µ–¥–∏—Ç–µ 'exit', '–≤—ã—Ö–æ–¥' –∏–ª–∏ 'quit' –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è\n")
        
        while True:
            try:
                question = input("–í—ã: ").strip()
                
                if not question:
                    continue
                
                if question.lower() in ["exit", "–≤—ã—Ö–æ–¥", "quit"]:
                    print("\n–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –ë—É–¥—É —Ä–∞–¥ –ø–æ–º–æ—á—å –≤–∞–º —Å–Ω–æ–≤–∞.")
                    break
                
                print("\n–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç:")
                answer = self.query(question)
                print(answer + "\n")
                
            except KeyboardInterrupt:
                print("\n\n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.")
                break
            except Exception as e:
                print(f"\n‚ö† –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}\n")


def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("="*60)
    print("–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø RAG-–°–ò–°–¢–ï–ú–´ (–ë–´–°–¢–†–ê–Ø –í–ï–†–°–ò–Ø)")
    print("="*60)
    
    base_dir = Path(__file__).parent
    
    try:
        rag = RAGSystemSimple(base_dir)
        
        rag.initialize_embeddings()
        rag.load_knowledge_base()
        rag.create_catalog_database()
        
        print("\n‚úì –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!\n")
        
        rag.run_interactive()
        
    except KeyboardInterrupt:
        print("\n\n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.")
    except Exception as e:
        print(f"\n‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        return 1
    
    return 0


if __name__ == '__main__':
    sys.exit(main())

